var district=district||{};district.stripeCc=function(n){var t={},i={},a={},r={},e={element:{},htmlId:"#stripe-card-element"},d={};return t.init=function(e){a=e,t.initForm(),t.initVars(),t.paymentMethodListener(),t.toggleNewCard(),t.paymentController()},t.createToken=function(){console.log(d.country),a.createToken(e.element,{address_country:d.country,address_line1:d.line1,address_zip:d.zip,name:d.name}).then(function(e){e.error?(r.text(e.error.message).addClass("validation-advice"),t.resetToken()):(r.empty().removeClass("validation-advice"),t.setToken(e.token.id))})},t.resetToken=function(){i.cardToken.val("")},t.setToken=function(e){i.cardToken.val(e)},t.paymentController=function(){"undefined"!=typeof Payment?("undefined"!=typeof billing&&t.getBillingAddressFrontend(),t.addEventsListeners()):"undefined"!=typeof AdminOrder&&(t.addEventsListeners(),AdminOrder.prototype.getPaymentData=AdminOrder.prototype.getPaymentData.wrap(t.paymentDataChange))},t.addEventsListeners=function(){e.element.addEventListener("change",function(e){e.error?(r.text(e.error.message).addClass("validation-advice"),t.resetToken()):(r.empty().removeClass("validation-advice"),t.createToken())})},t.toggleNewCard=function(){i.savedCard.change(function(){i.savedCard.parent().removeClass("district-label-active").end().filter(n(this)).parent().addClass("district-label-active"),""===n(this).val()?(n("#stripe-cards-select-new").show(),t.disableContinueBtn(!0)):(n("#stripe-cards-select-new").hide(),t.disableContinueBtn(!1))})},t.paymentMethodListener=function(){t.disableContinueBtn(!0),n("input[name=payment\\[method\\]]").click(function(){t.disableContinueBtn(!0)})},t.initForm=function(){e.element=a.elements().create("card",{style:{}}),e.element.mount(e.htmlId)},t.initVars=function(){i.cardToken=n("input#stripe_token"),i.savedCard=n("input[name=stripeSavedCard]"),i.continueBtn=n("#payment-buttons-container button:first"),r=n("#stripe-card-errors")},t.disableContinueBtn=function(e){"undefined"!=typeof payment&&"stripe_cc"===payment.currentMethod||(e=!1),i.continueBtn.prop("disabled",e).toggleClass("disabled",e)},t.paymentDataChange=function(e){t.getBillingAddressAdmin(),e()},t.getBillingAddressFrontend=function(){var e=n("#billing-address-select");e.length&&""!=e.val()?n.ajax({url:billing.addressUrl+e.val()}).done(function(e){d.line1=e.street1,d.zip=e.postcode,d.country=e.country_id,d.name=e.firstname+" "+e.lastname}):(d.line1=n("#billing\\:street1").val(),d.zip=n("#billing\\:postcode").val(),d.country=n("#billing\\:country_id").val(),d.name=n("#billing\\:firstname").val()+" "+n("#billing\\:lastname").val())},t.getBillingAddressAdmin=function(){d.line1=n("#order-billing_address_street0").val(),d.zip=n("#order-billing_address_postcode").val(),d.country=n("#order-billing_address_country_id").val(),d.name=n("#order-billing_address_firstname").val()+" "+n("#order-billing_address_lastname").val()},t}(window.district.$||window.jQuery);